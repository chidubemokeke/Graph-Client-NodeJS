'use strict';

const utils = require('@graphql-tools/utils');
const graphql = require('graphql');

class AddSourceNameTransform {
    constructor({ apiName }) {
        this.noWrap = true;
        this.apiName = apiName;
    }
    transformSchema(schema) {
        return utils.mapSchema(schema, {
            [utils.MapperKind.OBJECT_TYPE]: (type) => {
                const typeConfig = type.toConfig();
                typeConfig.fields.sourceName = {
                    type: graphql.GraphQLString,
                    resolve: () => this.apiName,
                };
                return new graphql.GraphQLObjectType(typeConfig);
            },
        });
    }
}

module.exports = AddSourceNameTransform;
