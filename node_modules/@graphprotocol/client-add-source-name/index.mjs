import { mapSchema, MapperKind } from '@graphql-tools/utils';
import { GraphQLString, GraphQLObjectType } from 'graphql';

class AddSourceNameTransform {
    constructor({ apiName }) {
        this.noWrap = true;
        this.apiName = apiName;
    }
    transformSchema(schema) {
        return mapSchema(schema, {
            [MapperKind.OBJECT_TYPE]: (type) => {
                const typeConfig = type.toConfig();
                typeConfig.fields.sourceName = {
                    type: GraphQLString,
                    resolve: () => this.apiName,
                };
                return new GraphQLObjectType(typeConfig);
            },
        });
    }
}

export default AddSourceNameTransform;
